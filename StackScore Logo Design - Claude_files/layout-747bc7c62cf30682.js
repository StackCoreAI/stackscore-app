(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4114],{2341:(e,t,n)=>{"use strict";n.d(t,{B:()=>l,N:()=>u});var r=n(54568),a=n(7620);let i=(0,a.createContext)(null),l=()=>{let e=(0,a.useContext)(i);return void 0===e?null:e},u=e=>{let{children:t,settings:n}=e;return(0,r.jsx)(i.Provider,{value:n,children:t})}},5183:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(54568),a=n(77187);function i(e){let{children:t}=e;return(0,r.jsx)(a.c7,{children:t})}},5984:(e,t,n)=>{var r=n(7692),a=n(26087),i=n(52968),l=0/0,u=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return l;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=o.test(e);return n||s.test(e)?c(e.slice(2),n?2:8):u.test(e)?l:+e}},6363:(e,t,n)=>{var r=n(83539),a=n(5984);e.exports=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=a(n))==n?n:0),void 0!==t&&(t=(t=a(t))==t?t:0),r(a(e),t,n)}},7692:(e,t,n)=>{var r=n(27230),a=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(a,""):e}},7726:(e,t,n)=>{"use strict";n.d(t,{sk:()=>m,dy:()=>_,Rs:()=>K,Fn:()=>S,CW:()=>O,bT:()=>T,t7:()=>L,Vt:()=>U,uE:()=>C,OZ:()=>M,O2:()=>x,mz:()=>p,FG:()=>A,Bq:()=>E,EV:()=>b,Lo:()=>R,_W:()=>w,yu:()=>k,HA:()=>D,HF:()=>Y,Pt:()=>q,HI:()=>z,Du:()=>I,wR:()=>V,aC:()=>j,gG:()=>P,uC:()=>F,lj:()=>N});var r=n(98518),a=n(77186),i=n(1761),l=n(2341),u=n(53248),o=n(71473),s=n(7620),c=n(75632),d=n(70825),f=n(87606),v=n(92012),g=n.n(v),h=n(62942),y=n(57067);let p=e=>{let t=(0,f.useQueryClient)(),{activeOrganization:n}=(0,i.YL)(),r=null==n?void 0:n.uuid,a=function(e){let t=JSON.stringify(e);return(0,s.useMemo)(()=>e,[t])}([o.fC,{orgUUID:r},{uuid:e}]);return t.getQueryData(a)},m=30,_=1e4,b=e=>{let{limit:t,offset:n,enabled:r=!0,starred:l,searchQuery:u}=e,{activeOrganization:s}=(0,i.YL)(),c=null==s?void 0:s.uuid,d=new URLSearchParams;void 0!==t&&d.append("limit",t.toString()),void 0!==n&&d.append("offset",n.toString()),void 0!==l&&d.append("starred",l.toString()),void 0!==u&&d.append("searchQuery",u);let f=d.toString();return f=f?"?".concat(f):"",(0,a.Sk)("/api/organizations/".concat(null!=c?c:"","/chat_conversations").concat(f),{queryKey:[o.DC,{orgUUID:c},{limit:t,offset:n,starred:l,searchQuery:u}],staleTime:3e5,enabled:!!c&&r})},S=()=>{let{activeOrganization:e}=(0,i.YL)(),t=null==e?void 0:e.uuid;return(0,a.Sk)("/api/organizations/".concat(t,"/chat_conversations/count_all"),{queryKey:[o.Ad,{orgUUID:t}],staleTime:3e5,enabled:!!t})},C=()=>{let{activeOrganization:e}=(0,i.YL)(),t=(0,a.mn)();return(0,s.useCallback)(async n=>{let{limit:r,offset:a}=n,i=new URLSearchParams;void 0!==r&&i.append("limit",r.toString()),void 0!==a&&i.append("offset",a.toString());let l=i.toString();return l=l?"?".concat(l):"",(await t("/api/organizations/".concat(null==e?void 0:e.uuid,"/chat_conversations").concat(l))).json()},[null==e?void 0:e.uuid,t])},E=function(e){let{suppressError:t,enabled:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0},{activeOrganization:r}=(0,i.YL)(),l=null==r?void 0:r.uuid,u=(0,s.useRef)([]),c=(0,f.useQueryClient)(),d="/api/organizations/".concat(null!=l?l:"","/chat_conversations/").concat(e,"?tree=True&rendering_mode=messages&render_all_tools=true"),v=(0,a.Sk)(d,{queryKey:[o.fC,{orgUUID:l},{uuid:e}],staleTime:3e5,enabled:!!l&&!!e&&n,meta:{noToast:t}},t=>(c.invalidateQueries({queryKey:[o.XF,{orgUUID:l,conversationUUID:e}]}),(0,y.H6)(t))),h=(0,s.useMemo)(()=>{if(!v.data)return u.current=[],u.current;let e=(0,y.$)(v.data);if(e.length!==u.current.length||e.some((e,t)=>{var n;return e.uuid!==(null==(n=u.current[t])?void 0:n.uuid)}))return u.current=e,u.current;for(let t=0;t<e.length;t++)g()(e[t],u.current[t])||(u.current[t]=e[t]);return u.current},[v.data]);return{...v,currentPath:h}},w=e=>{let t=(0,f.useQueryClient)(),{activeOrganization:n}=(0,i.YL)(),r=null==n?void 0:n.uuid;return(0,s.useCallback)(()=>{t.invalidateQueries({queryKey:[o.fC,{orgUUID:r},{uuid:e}]})},[t,r,e])},T=(e,t)=>{let{mutateAsync:n}=O(),r=(0,h.useRouter)(),a=t||(0,c.N)();return(0,s.useCallback)(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{model:void 0,controlsOpen:!1},i={uuid:a,name:"",model:t.model};t.createMode&&(i.create_mode=t.createMode),t.projectUuid&&(i.project_uuid=t.projectUuid),n(i).then(()=>{let n="/chat/".concat(a).concat(t.controlsOpen?"?controls=1":"");r[e](n)}).catch(e=>{(0,d.Cp)(e)})},[n,r,e,a])},O=()=>{let{activeOrganization:e}=(0,i.YL)(),t=null==e?void 0:e.uuid,n=(0,f.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(null!=t?t:"","/chat_conversations"),"POST",{enabled:!!t,onSuccess:e=>{let r;n.setQueryData((r=e.uuid,[o.fC,{orgUUID:t},{uuid:r}]),t=>({...t||{},...e,chat_messages:(null==t?void 0:t.chat_messages)||[],messageByUuid:new Map,parentByChildUuid:new Map,childrenByParentUuid:new Map,selectedChildByUuid:new Map}))}})},L=()=>{let{activeOrganization:e}=(0,i.YL)(),t=null==e?void 0:e.uuid,n=(0,f.useQueryClient)();return(0,a.Qv)(e=>{let{uuid:n}=e;return"/api/organizations/".concat(null!=t?t:"","/chat_conversations/").concat(n)},"DELETE",(e,t)=>{let{uuid:n}=e;if(!t)return[];let r=t.findIndex(e=>e.uuid===n);if(!(r>-1))return t;{let e=[...t];return e.splice(r,1),e}},{enabled:!!t,queryKey:[o.DC,{orgUUID:t}],onSuccess:async(e,r)=>{let{uuid:a,projectUuid:i}=r;await n.invalidateQueries({queryKey:[o.fC,{orgUUID:t},{uuid:a}]}),i&&await n.invalidateQueries({queryKey:[o.yF,{orgUuid:t,projectUuid:i}]}),await B(n,t)}})},U=e=>{let{activeOrganization:t}=(0,i.YL)(),n=null==t?void 0:t.uuid,r=(0,f.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(n,"/chat_conversations/delete_many"),"POST",{onSuccess:async t=>{await B(r,n),e&&e(t)}})},k=()=>{let{activeOrganization:e}=(0,i.YL)(),t=null==e?void 0:e.uuid;return(0,a.Sk)("/api/organizations/".concat(t,"/shares"),{queryKey:[o._J,{orgUUID:t}],enabled:!!t,staleTime:3e5})},x=e=>{let{activeOrganization:t}=(0,i.YL)(),n=null==t?void 0:t.uuid;return(0,a.Sk)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/latest"),{enabled:!!n&&!!e,queryKey:[o.XF,{orgUUID:n,conversationUUID:e}],staleTime:0,meta:{noToast:!0}},e=>{let{snapshot:t,shareable:n,disabled_reason:r}=e;return{shareable:n,disabled_reason:r,snapshot:t?{...t,chat_messages:t.chat_messages.map(e=>(0,y.XU)(e))}:null}})},A=e=>{let{activeOrganization:t,account:n}=(0,i.YL)(),r=null==t?void 0:t.uuid,l=n&&r?"/api/organizations/".concat(r,"/chat_snapshots/").concat(e,"?rendering_mode=messages&render_all_tools=true"):"/api/chat_snapshots/".concat(e,"?rendering_mode=messages&render_all_tools=true");return(0,a.Sk)(l,{retry:!1,refetchInterval:!1,enabled:!!e,staleTime:0,queryKey:[o.Bn,{orgUUID:r,snapshotUUID:e}]},e=>({...e,chat_messages:e.chat_messages.map(e=>(0,y.XU)(e))}))},I=e=>{let{activeOrganization:t}=(0,i.YL)(),n=null==t?void 0:t.uuid,r=(0,f.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/share"),"POST",{onSuccess:()=>{r.invalidateQueries({queryKey:[o.XF,{orgUUID:n,conversationUUID:e}]}),r.invalidateQueries({queryKey:[o._J,{orgUUID:n}]}),r.invalidateQueries({queryKey:[o.A2,{orgUUID:n}]})}})},P=(e,t)=>{let{activeOrganization:n}=(0,i.YL)(),r=null==n?void 0:n.uuid,l=(0,f.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(r,"/share/").concat(t),"DELETE",{enabled:!!r&&!!t,meta:{errorMessage:"There was an error while trying to unshare the conversation. Please try again."},onSuccess:()=>{l.invalidateQueries({queryKey:[o.XF,{orgUUID:r,conversationUUID:e}]}),l.invalidateQueries({queryKey:[o._J,{orgUUID:r}]}),l.invalidateQueries({queryKey:[o.A2,{orgUUID:r}]})}})},R=e=>{let{activeOrganization:t}=(0,i.YL)(),n=null==t?void 0:t.uuid;return(0,a.Sk)("/api/organizations/".concat(n,"/artifact-versions/").concat(e),{retry:!1,refetchInterval:!1,enabled:!!e&&!!n,staleTime:0,queryKey:[o.Fz,{artifactVersionUUID:e}]})},D=function(e,t,n){var u,s,c;let d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{track:v}=(0,r.st)(),g=null!=(s=null==(u=(0,l.B)())?void 0:u.preview_feature_uses_artifacts)&&s,{activeOrganization:h}=(0,i.YL)(),y=null==h?void 0:h.uuid,p=(0,f.useQueryClient)(),m=[o.fC,{orgUUID:y},{uuid:e}];return(0,a.L2)("/api/organizations/".concat(null!=y?y:"","/chat_conversations/").concat(e,"/chat_messages/").concat(null!=(c=t.uuid)?c:"","/chat_feedback"),t.chat_feedback?"PUT":"POST",{enabled:!!y,meta:{errorMessage:"We could not save your feedback. Please try again later."},...d,onSuccess(){for(var r,a,i=arguments.length,l=Array(i),u=0;u<i;u++)l[u]=arguments[u];v({event_key:"claudeai.conversation.feedback.sent",message_uuid:t.uuid,conversation_uuid:e,artifacts_enabled:g,conversationHasArtifacts:n,type:null==(r=t.chat_feedback)?void 0:r.type}),p.invalidateQueries({queryKey:m}),null==(a=d.onSuccess)||a.call(d,...l)}})},Q=()=>{let e=(0,f.useQueryClient)(),{activeOrganization:t}=(0,i.YL)(),n=null==t?void 0:t.uuid;return(0,s.useCallback)((t,r)=>{t&&(e.setQueryData([o.fC,{orgUUID:n},{uuid:t}],e=>e&&{...e,...r}),e.setQueriesData({queryKey:[o.DC,{orgUUID:n}]},e=>null==e?void 0:e.map(e=>e.uuid!==t?e:{...e,...r})))},[n,e])},z=e=>{let t=(0,f.useQueryClient)(),{activeOrganization:n}=(0,i.YL)(),r=null==n?void 0:n.uuid,l=Q();return(0,a.L2)("/api/organizations/".concat(r,"/chat_conversations/").concat(e),"PUT",{onMutate:n=>{var a;let{name:i}=n,u=t.getQueryData([o.fC,{orgUUID:r},{uuid:e}]);return l(e,{name:i}),{oldTitle:null!=(a=null==u?void 0:u.name)?a:""}},onError(t,n,r){r&&l(e,{name:r.oldTitle})}})},M=e=>{let t=Q(),{activeOrganization:n}=(0,i.YL)();return(0,a.L2)("/api/organizations/".concat(null==n?void 0:n.uuid,"/chat_conversations/").concat(e,"/title"),"POST",{onSuccess(n){let{title:r}=n;t(e,{name:null!=r?r:""})},meta:{noToast:!0}})};function K(e){var t,n;let r=(0,u.C)(e),a=e.attachments.map(e=>e.extracted_content).join(" ");return r+" "+a+" "+((null==(t=e.content)?void 0:t.filter(e=>"tool_use"===e.type).map(e=>e.input?JSON.stringify(e.input):e.partial_json||"").join(" "))||"")+" "+((null==(n=e.content)?void 0:n.filter(e=>"tool_result"===e.type).flatMap(e=>e.content.filter(e=>"text"===e.type).map(e=>e.text)).join(" "))||"")}let j=e=>{let{activeOrganization:t}=(0,i.YL)(),n=null==t?void 0:t.uuid;return(0,a.L2)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/stop_response"),"POST")},q=()=>{let{activeOrganization:e}=(0,i.YL)(),t=null==e?void 0:e.uuid;return(0,a.L2)(e=>{let{conversation_uuid:n}=e;return"/api/organizations/".concat(t,"/chat_conversations/").concat(n,"/tool_result")},"POST",{enabled:!!t,meta:{errorMessage:"We could not record the tool result. Please try again later."},transformVariables:e=>{let{conversation_uuid:t,...n}=e;return n}})},N=e=>{let{activeOrganization:t}=(0,i.YL)(),n=null==t?void 0:t.uuid;return(0,a.L2)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/current_leaf_message_uuid"),"PUT")},Y=(e,t)=>{let{activeOrganization:n}=(0,i.YL)(),r=(0,f.useQueryClient)(),l=null==n?void 0:n.uuid;return(0,a.Qv)("/api/organizations/".concat(l,"/chat_conversations/").concat(e,"?rendering_mode=raw"),"PUT",(e,t)=>t?{...t,settings:{...t.settings,...e.settings}}:void 0,{enabled:!!e,onSuccess:()=>{B(r,l)},onSettled:()=>{(null==t?void 0:t.refetchOnSettled)&&r.refetchQueries({queryKey:[o.fC,{orgUUID:l},{uuid:e}]})},queryKey:[o.fC,{orgUUID:l},{uuid:e}]})},B=async(e,t)=>{await Promise.all([e.invalidateQueries({queryKey:[o.DC,{orgUUID:t}]}),e.invalidateQueries({queryKey:[o.Ad,{orgUUID:t}]})])},V=e=>{let{activeOrganization:t}=(0,i.YL)(),n=(0,f.useQueryClient)(),r=null==t?void 0:t.uuid;return(0,a.Qv)("/api/organizations/".concat(r,"/chat_conversations/").concat(e,"?rendering_mode=raw"),"PUT",(e,t)=>t?{...t,...e}:void 0,{onSuccess:()=>{B(n,r)},queryKey:[o.fC,{orgUUID:r},{uuid:e}]})},F=e=>{let{activeOrganization:t}=(0,i.YL)(),n=(0,f.useQueryClient)(),r=null==t?void 0:t.uuid;return(0,a.Qv)("/api/organizations/".concat(r,"/chat_conversations/").concat(e,"?rendering_mode=raw"),"PUT",(e,t)=>{var n;return t?{...t,project_uuid:null!=(n=e.project_uuid)?n:void 0}:void 0},{onSuccess:()=>{B(n,r),n.invalidateQueries({queryKey:[o.yF]})},queryKey:[o.fC,{orgUUID:r},{uuid:e}]})}},16006:(e,t,n)=>{"use strict";n.d(t,{v:()=>a});var r=n(7620);function a(e){let[t,n]=(0,r.useState)(null),a=(0,r.useRef)(null);return{ref:(0,r.useCallback)(t=>{if(a.current&&(a.current.disconnect(),a.current=null),null===t)return void n(null);a.current=new IntersectionObserver(e=>{let[t]=e;n(t)},e),a.current.observe(t)},[null==e?void 0:e.rootMargin,null==e?void 0:e.root,null==e?void 0:e.threshold]),entry:t}}},27230:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},29098:e=>{!function(){"use strict";var t={114:function(e){function t(e){if("string"!=typeof e)throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,r="",a=0,i=-1,l=0,u=0;u<=e.length;++u){if(u<e.length)n=e.charCodeAt(u);else if(47===n)break;else n=47;if(47===n){if(i===u-1||1===l);else if(i!==u-1&&2===l){if(r.length<2||2!==a||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2)){if(r.length>2){var o=r.lastIndexOf("/");if(o!==r.length-1){-1===o?(r="",a=0):a=(r=r.slice(0,o)).length-1-r.lastIndexOf("/"),i=u,l=0;continue}}else if(2===r.length||1===r.length){r="",a=0,i=u,l=0;continue}}t&&(r.length>0?r+="/..":r="..",a=2)}else r.length>0?r+="/"+e.slice(i+1,u):r=e.slice(i+1,u),a=u-i-1;i=u,l=0}else 46===n&&-1!==l?++l:l=-1}return r}var r={resolve:function(){for(var e,r,a="",i=!1,l=arguments.length-1;l>=-1&&!i;l--)l>=0?r=arguments[l]:(void 0===e&&(e=""),r=e),t(r),0!==r.length&&(a=r+"/"+a,i=47===r.charCodeAt(0));if(a=n(a,!i),i)if(a.length>0)return"/"+a;else return"/";return a.length>0?a:"."},normalize:function(e){if(t(e),0===e.length)return".";var r=47===e.charCodeAt(0),a=47===e.charCodeAt(e.length-1);return(0!==(e=n(e,!r)).length||r||(e="."),e.length>0&&a&&(e+="/"),r)?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0==arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var a=arguments[n];t(a),a.length>0&&(void 0===e?e=a:e+="/"+a)}return void 0===e?".":r.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n||(e=r.resolve(e))===(n=r.resolve(n)))return"";for(var a=1;a<e.length&&47===e.charCodeAt(a);++a);for(var i=e.length,l=i-a,u=1;u<n.length&&47===n.charCodeAt(u);++u);for(var o=n.length-u,s=l<o?l:o,c=-1,d=0;d<=s;++d){if(d===s){if(o>s){if(47===n.charCodeAt(u+d))return n.slice(u+d+1);else if(0===d)return n.slice(u+d)}else l>s&&(47===e.charCodeAt(a+d)?c=d:0===d&&(c=0));break}var f=e.charCodeAt(a+d);if(f!==n.charCodeAt(u+d))break;47===f&&(c=d)}var v="";for(d=a+c+1;d<=i;++d)(d===i||47===e.charCodeAt(d))&&(0===v.length?v+="..":v+="/..");return v.length>0?v+n.slice(u+c):(u+=c,47===n.charCodeAt(u)&&++u,n.slice(u))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),r=47===n,a=-1,i=!0,l=e.length-1;l>=1;--l)if(47===(n=e.charCodeAt(l))){if(!i){a=l;break}}else i=!1;return -1===a?r?"/":".":r&&1===a?"//":e.slice(0,a)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw TypeError('"ext" argument must be a string');t(e);var r,a=0,i=-1,l=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var u=n.length-1,o=-1;for(r=e.length-1;r>=0;--r){var s=e.charCodeAt(r);if(47===s){if(!l){a=r+1;break}}else -1===o&&(l=!1,o=r+1),u>=0&&(s===n.charCodeAt(u)?-1==--u&&(i=r):(u=-1,i=o))}return a===i?i=o:-1===i&&(i=e.length),e.slice(a,i)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!l){a=r+1;break}}else -1===i&&(l=!1,i=r+1);return -1===i?"":e.slice(a,i)},extname:function(e){t(e);for(var n=-1,r=0,a=-1,i=!0,l=0,u=e.length-1;u>=0;--u){var o=e.charCodeAt(u);if(47===o){if(!i){r=u+1;break}continue}-1===a&&(i=!1,a=u+1),46===o?-1===n?n=u:1!==l&&(l=1):-1!==n&&(l=-1)}return -1===n||-1===a||0===l||1===l&&n===a-1&&n===r+1?"":e.slice(n,a)},format:function(e){var t,n;if(null===e||"object"!=typeof e)throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return t=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||""),t?t===e.root?t+n:t+"/"+n:n},parse:function(e){t(e);var n,r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;var a=e.charCodeAt(0),i=47===a;i?(r.root="/",n=1):n=0;for(var l=-1,u=0,o=-1,s=!0,c=e.length-1,d=0;c>=n;--c){if(47===(a=e.charCodeAt(c))){if(!s){u=c+1;break}continue}-1===o&&(s=!1,o=c+1),46===a?-1===l?l=c:1!==d&&(d=1):-1!==l&&(d=-1)}return -1===l||-1===o||0===d||1===d&&l===o-1&&l===u+1?-1!==o&&(0===u&&i?r.base=r.name=e.slice(1,o):r.base=r.name=e.slice(u,o)):(0===u&&i?(r.name=e.slice(1,l),r.base=e.slice(1,o)):(r.name=e.slice(u,l),r.base=e.slice(u,o)),r.ext=e.slice(l,o)),u>0?r.dir=e.slice(0,u-1):i&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,e.exports=r}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={exports:{}},l=!0;try{t[e](i,i.exports,r),l=!1}finally{l&&delete n[e]}return i.exports}r.ab="//",e.exports=r(114)}()},46127:(e,t,n)=>{"use strict";n.d(t,{Vc:()=>l,Wz:()=>i});var r=n(30686),a=n(7620);function i(e,t){return(0,r.F)({key:"SSS-".concat(e),defaultValue:t,serialize:JSON.stringify,deserialize:e=>void 0===e?t:JSON.parse(e)})}function l(e,t){return function(e){var t,n,r;let{key:i,defaultValue:l,deserialize:u=JSON.parse,getInitialValueInEffect:o=!1,sync:s=!0}=e,c="LSS-".concat(i),d=(0,a.useRef)(null!=(r=null==(t=(n=crypto).randomUUID)?void 0:t.call(n))?r:"".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2))),f=(0,a.useRef)(!1),[v,g]=(0,a.useState)(()=>{if(o)return l;try{let e=window.localStorage.getItem(c);if(e){let t=JSON.parse(e);if(t&&"object"==typeof t&&"value"in t)return t.value;return u(e)}}catch(e){console.warn("Error reading localStorage key “".concat(c,"”:"),e)}return l});(0,a.useEffect)(()=>{if(o)try{let e=window.localStorage.getItem(c);if(e){let t=JSON.parse(e);t&&"object"==typeof t&&"value"in t?g(t.value):g(u(e))}}catch(e){console.warn("Error reading localStorage key “".concat(c,"”:"),e)}},[c,u,o]);let h=(0,a.useCallback)(e=>{f.current=!0,g(t=>{let n="function"==typeof e?e(t):e;try{let e={value:n,tabId:d.current,timestamp:Date.now()},t=JSON.stringify(e);if(window.localStorage.setItem(c,t),s){let e=new StorageEvent("storage",{key:c,newValue:t,oldValue:window.localStorage.getItem(c),storageArea:window.localStorage,url:window.location.href});window.dispatchEvent(e)}}catch(e){console.warn("Error writing localStorage key “".concat(c,"”:"),e)}return n}),Promise.resolve().then(()=>{f.current=!1})},[c,s]),y=(0,a.useCallback)(()=>{window.localStorage.removeItem(c),g(l)},[c,l]);return(0,a.useEffect)(()=>{if(!s)return;let e=e=>{if(e.key===c&&e.newValue&&!f.current)try{let t=JSON.parse(e.newValue);if(t&&"object"==typeof t&&"value"in t&&"tabId"in t){if(t.tabId===d.current)return;g(t.value)}else g(u(e.newValue))}catch(e){console.warn("Error handling storage event for “".concat(c,"”:"),e)}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[c,s,u]),[v,h,y]}({key:e,defaultValue:t,deserialize:e=>void 0===e?t:JSON.parse(e),getInitialValueInEffect:!1,sync:!0})}},51121:(e,t,n)=>{"use strict";n.d(t,{ErrorsProvider:()=>m,Y:()=>_,i:()=>C});var r=n(54568),a=n(63246),i=n(27062),l=n(90819),u=n.n(l),o=n(58648),s=n.n(o),c=n(26836),d=n.n(c),f=n(62942),v=n(7620),g=n(75006),h=n(1761),y=n(46127);let p=(0,v.createContext)(void 0);function m(e){let{children:t}=e,n=(0,v.useRef)(1),[a,i]=(0,v.useState)([]),l=(0,v.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[]),u=(0,v.useCallback)((e,t)=>{let r=n.current++;return i(t=>[...t,{id:r,message:e instanceof Error?e.message:e,toastType:"error"}]),t&&setTimeout(()=>l(r),t),r},[l]),o=(0,v.useCallback)((e,t)=>{let r=n.current++;return i(t=>[...t,{id:r,message:e,toastType:"success"}]),t&&setTimeout(()=>l(r),t),r},[l]),s=(0,v.useMemo)(()=>({toasts:a,addError:u,addSuccess:o,clearToast:l}),[a,u,o,l]);return(0,r.jsx)(p.Provider,{value:s,children:t})}function _(){let e=(0,v.useContext)(p);if(!e)throw Error("Must be called within ErrorsProvider");return e}let b=g.z.object({id:g.z.string().optional().nullable(),title:g.z.string().optional().nullable(),message:g.z.string().optional().nullable(),displayFrequencyHours:g.z.number().optional().nullable()}),S={};function C(){var e;let{id:t,title:n,message:r,displayFrequencyHours:l}=(0,i.iW)("claude_system_message",S,b),{account:o}=(0,h.YL)(),c=null!=(e=null==o?void 0:o.uuid)?e:"logged-out",g=(0,f.usePathname)(),[p,m]=(0,y.Vc)("dismissed-system-messages",{}),_=(0,v.useMemo)(()=>()=>m(e=>{let n=u()(e);return t&&d()(n,[c,t],Date.now()),n}),[m,c,t]);return(0,v.useMemo)(()=>{if(!o||(0,a.Xs)(o,!0)||"/download"===g||!t)return!1;let e=s()(p,[c,t]);return!e||"boolean"==typeof e||!!l&&Date.now()-e>=60*l*6e4},[o,t,c,p,l,g])?{currentSystemMessageId:t,currentSystemMessageTitle:n,currentSystemMessageContent:r,dismissCurrentSystemMessage:_}:{currentSystemMessageId:null,currentSystemMessageTitle:null,currentSystemMessageContent:null,dismissCurrentSystemMessage:()=>null}}},53248:(e,t,n)=>{"use strict";n.d(t,{C:()=>r});let r=e=>{let t="";if(e.content)for(let n of e.content)"text"===n.type&&(t+=n.text);return t}},55554:(e,t,n)=>{"use strict";n.d(t,{TierSelectorProvider:()=>d,t:()=>c});var r=n(54568),a=n(46612),i=n(27062),l=n(85544),u=n(7620),o=n(96712);let s=(0,u.createContext)(null),c=()=>{let e=(0,u.useContext)(s);if(!e)throw Error("useTierSelector must be used within a TierSelectorProvider");return e},d=e=>{var t;let{children:n,initialEnabled:c=!1}=e,d=(0,o.l)(),[f,v]=(0,u.useState)(()=>d.get(a.eT.SELECTED_TIER)||null),[g,h]=(0,u.useState)(()=>"true"===d.get(a.eT.SHOULD_OVERRIDE_TOKEN_LIMITS)),[y,p]=(0,u.useState)(()=>"true"===d.get(a.eT.SHOULD_OVERRIDE_FEATURE_ACCESS)),m=null!=(t=(0,i.fS)("internal_tier_selector").value)?t:c,_=(0,u.useState)(m)[1],b=(0,u.useCallback)(()=>{let e=[l.d7.FREE,l.d7.PRO,l.d7.ENTERPRISE,l.d7.MAX],t=Math.floor(Math.random()*e.length);return e[t]},[]),S=(0,u.useCallback)(e=>{if(!m)return void v(e);if(null===e){let e=f||b();d.set(a.eT.SELECTED_TIER,e,{maxAgeSeconds:2592e3})}else d.set(a.eT.SELECTED_TIER,e);v(e)},[f,v,d,b,m]);(0,u.useEffect)(()=>{m?f&&d.set(a.eT.SELECTED_TIER,f):d.delete(a.eT.SELECTED_TIER)},[m,f,d]);let C=(0,u.useCallback)(e=>{if(!m)return void h(e);e?d.set(a.eT.SHOULD_OVERRIDE_TOKEN_LIMITS,"true"):d.delete(a.eT.SHOULD_OVERRIDE_TOKEN_LIMITS),h(e)},[m,d]),E=(0,u.useCallback)(e=>{if(!m)return void p(e);e?d.set(a.eT.SHOULD_OVERRIDE_FEATURE_ACCESS,"true"):d.delete(a.eT.SHOULD_OVERRIDE_FEATURE_ACCESS),p(e)},[m,d]);return(0,u.useEffect)(()=>{m||(d.delete(a.eT.SHOULD_OVERRIDE_TOKEN_LIMITS),d.delete(a.eT.SHOULD_OVERRIDE_FEATURE_ACCESS))},[m,d]),(0,r.jsx)(s.Provider,{value:{selectedTier:f,isTierSelectorEnabled:m,setSelectedTier:S,setIsTierSelectorEnabled:_,shouldOverrideTokenLimits:g,setShouldOverrideTokenLimits:C,shouldOverrideFeatureAccess:y,setShouldOverrideFeatureAccess:E},children:n})}},57067:(e,t,n)=>{"use strict";n.d(t,{$:()=>y,AP:()=>d,GN:()=>s,Gp:()=>c,H6:()=>v,Rh:()=>u,XU:()=>f,ZQ:()=>g,gF:()=>o,gX:()=>p,gv:()=>l,xQ:()=>h});var r=n(70825),a=n(6363),i=n.n(a);let l="new-assistant-message-uuid",u="new-human-message-uuid",o="00000000-0000-4000-8000-000000000000",s=e=>e!==l;function c(e,t){let n=e.get(t);if(void 0===n){let e=Error("Key not found: ".concat(t));throw(0,r.Cp)(e),e}return n}let d=(e,t)=>{let n=null!=t?t:e.current_leaf_message_uuid;if(!n)return e;for(;n!==o;){var r;let t=c(e.parentByChildUuid,n),a=null==(r=c(e.childrenByParentUuid,t))?void 0:r.indexOf(n);e.selectedChildByUuid.set(t,a),n=t}return{...e,current_leaf_message_uuid:t}},f=e=>e.content?e:{...e,content:[{type:"text",text:e.text||"",citations:[]}]},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Set;for(let t of e.chat_messages)"assistant"===t.sender&&t.parent_message_uuid&&n.add(t.parent_message_uuid);let r=e.chat_messages.filter(e=>"assistant"===e.sender||n.has(e.uuid)||void 0===e.parent_message_uuid||t),a={...e,chat_messages:r},i={...a,...(e=>{var t,n,r;let a=new Map,i=new Map,l=new Map,u=new Map,s=new Map;if(0===e.chat_messages.length)return{messageByUuid:i,parentByChildUuid:l,childrenByParentUuid:u,selectedChildByUuid:s};let c=e.chat_messages.map(f);for(let e of c)a.set(e.index,e),i.set(e.uuid,e);for(let e of c){let t=e.parent_message_uuid;if(!t){let r=e.index-1;for(;!t&&r>=0;)t=null==(n=a.get(r))?void 0:n.uuid,r--}t=null!=t?t:o,l.set(e.uuid,t),u.set(t,(null!=(r=u.get(t))?r:[]).concat(e.uuid)),s.set(t,0)}if(!(null==(t=u.get(o))?void 0:t[0]))throw Error("No root message found");return{chat_messages:c,messageByUuid:i,parentByChildUuid:l,childrenByParentUuid:u,selectedChildByUuid:s}})(a)};return i.current_leaf_message_uuid||d(i),d(i,a.current_leaf_message_uuid)},g=e=>{let t=Array.from(e.messageByUuid.values()).map(e=>e.index);return 0===t.length?-1:Math.max(...t)},h=(e,t)=>{for(let r of(e.chat_messages=e.chat_messages.concat(t),t)){var n;if(!r.parent_message_uuid)throw Error("Parent UUID required");let t=r.parent_message_uuid;e.messageByUuid.set(r.uuid,r),e.parentByChildUuid.set(r.uuid,t);let a=null!=(n=e.childrenByParentUuid.get(t))?n:[];a.push(r.uuid),e.childrenByParentUuid.set(t,a),e.selectedChildByUuid.set(t,a.length-1)}return d(e,t[t.length-1].uuid)},y=(e,t)=>{let n=[],r=null!=t?t:o;for(;e.childrenByParentUuid.has(r);){let t=c(e.childrenByParentUuid,r);if(0===t.length)break;let a=c(e.selectedChildByUuid,r),i=c(e.messageByUuid,t[a]);n.push({...i,parent_message_uuid:r,nOptions:t.length,selectedOption:a}),r=i.uuid}return n};function p(e,t,n){var r;let a=c(e.parentByChildUuid,t.uuid),l=c(e.childrenByParentUuid,a),u=i()((null!=(r=t.selectedOption)?r:0)+n,0,l.length-1);e.selectedChildByUuid.set(a,u);let o=y(e,a);return d(e,o[o.length-1].uuid)}},63246:(e,t,n)=>{"use strict";n.d(t,{Ah:()=>l,Bs:()=>a,NJ:()=>i,VH:()=>r,Xs:()=>o,u5:()=>u});let r=e=>{let{account:t,isClaudeDot:n}=e;return n?!1===t.settings.has_finished_claudeai_onboarding:!t.full_name||!t.display_name},a=(e,t)=>t&&!e.is_verified,i=(e,t)=>!!function(e,t){for(let n of e.invites)if(n.organization.capabilities&&n.organization.capabilities.includes(t))return n}(e,t?"raven":"api"),l=(e,t)=>!t&&0===e.invites.length&&0===e.memberships.filter(e=>e.organization.capabilities.includes("api")).length,u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n&&t&&!e.age_is_verified},o=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r({account:e,isClaudeDot:t})||a(e,t)||i(e,t)||l(e,t)||u(e,t,n)}},70157:(e,t,n)=>{Promise.resolve().then(n.bind(n,5183))},72034:(e,t,n)=>{"use strict";async function r(e,t){let n,r=e.getReader();for(;!(n=await r.read()).done;)t(n.value)}function a(){return{data:"",event:"",id:"",retry:void 0}}n.d(t,{o:()=>l,y:()=>o});var i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)0>t.indexOf(r[a])&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};let l="text/event-stream",u="last-event-id";function o(e,t){var{signal:n,headers:o,onopen:c,onmessage:d,onclose:f,onerror:v,openWhenHidden:g,fetch:h}=t,y=i(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((t,i)=>{let p,m=Object.assign({},o);function _(){p.abort(),document.hidden||T()}m.accept||(m.accept=l),"undefined"==typeof document||g||document.addEventListener("visibilitychange",_);let b=1e3,S=0;function C(){"undefined"==typeof document||g||document.removeEventListener("visibilitychange",_),clearTimeout(S),p.abort()}null==n||n.addEventListener("abort",()=>{C(),t()});let E=null!=h?h:fetch,w=null!=c?c:s;async function T(){var n,l;p=new AbortController;try{let n,i,o,s,c=await E(e,Object.assign(Object.assign({},y),{headers:m,signal:p.signal}));await w(c),await r(c.body,(l=function(e,t,n){let r=a(),i=new TextDecoder;return function(l,u){if(0===l.length)null==e||e(r),r=a();else if(u>0){let e=i.decode(l.subarray(0,u)),a=u+(32===l[u+1]?2:1),o=i.decode(l.subarray(a));switch(e){case"data":r.data=r.data?r.data+"\n"+o:o;break;case"event":r.event=o;break;case"id":null==t||t(r.id=o);break;case"retry":let s=parseInt(o,10);isNaN(s)||null==n||n(r.retry=s)}}}}(d,e=>{e?m[u]=e:delete m[u]},e=>{b=e}),s=!1,function(e){void 0===n?(n=e,i=0,o=-1):n=function(e,t){let n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(n,e);let t=n.length,r=0;for(;i<t;){s&&(10===n[i]&&(r=++i),s=!1);let e=-1;for(;i<t&&-1===e;++i)switch(n[i]){case 58:-1===o&&(o=i-r);break;case 13:s=!0;case 10:e=i}if(-1===e)break;l(n.subarray(r,e),o),r=i,o=-1}r===t?n=void 0:0!==r&&(n=n.subarray(r),i-=r)})),null==f||f(),C(),t()}catch(e){if(!p.signal.aborted)try{let t=null!=(n=null==v?void 0:v(e))?n:b;clearTimeout(S),S=setTimeout(T,t)}catch(e){C(),i(e)}}}T()})}function s(e){let t=e.headers.get("content-type");if(!(null==t?void 0:t.startsWith(l)))throw Error(`Expected content-type to be ${l}, Actual: ${t}`)}},75632:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});let r=()=>void 0===crypto.randomUUID?"".concat(1e7,"-",1e3,"-",4e3,"-",8e3,"-",1e11).replace(/[018]/g,e=>{let t=parseInt(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}):crypto.randomUUID()},83539:e=>{e.exports=function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}},92012:(e,t,n)=>{var r=n(89412);e.exports=function(e,t){return r(e,t)}}},e=>{e.O(0,[2971,7261,2846,5006,1036,9474,5015,7773,4974,8864,1761,8518,7187,587,842,7378,7358],()=>e(e.s=70157)),_N_E=e.O()}]);