(()=>{(()=>{function m(t){try{t&&t()}catch{}}function y(t,s){return new URLSearchParams(location.search).get(t)||s}function f(t){if(typeof t!="string")return null;try{return JSON.parse(t)}catch{return null}}function w(t=""){return t=t.toLowerCase(),t.includes("boost")?"zap":t.includes("kikoff")?"credit-card":t.includes("kovo")?"trending-up":t.includes("rent")?"home":t.includes("dispute")?"shield-check":"star"}function g(t,s){let n=(t||"").toLowerCase();return s?.step1||s?.step2||s?.step3?[s.step1||"",s.step2||"",s.step3||""]:n.includes("experian")&&n.includes("boost")?["Instant Credit Score Boost","Connect Bank","Add Utilities"]:n.includes("kikoff")?["Open Kikoff Credit Account","Enable Autopay","Keep Utilization <10%"]:n.includes("kovo")?["Create Kovo Account","Choose Monthly Plan","Make On-Time Payments"]:n.includes("self")?["Open Self Credit Builder","Fund First Deposit","Auto-pay On"]:n.includes("rent")||n.includes("boom")||n.includes("rentreporter")?["Verify Lease","Connect Payment Source","Backdate (if eligible)"]:n.includes("dispute")||n.includes("dovly")?["Import Report","Auto-scan Issues","Submit Round-1 Disputes"]:["Start \xB7 Create account","Connect \xB7 Bank/Payment","Activate \xB7 Feature"]}document.addEventListener("DOMContentLoaded",()=>{m(()=>window.lucide&&lucide.createIcons()),document.querySelectorAll("[data-anim]").forEach((t,s)=>setTimeout(()=>t.classList.add("show"),s*150))}),document.addEventListener("DOMContentLoaded",()=>{let t=`ss:${y("t","anon")}:`;document.querySelectorAll('input[type="checkbox"]').forEach((r,l)=>{let p=`${t}cb:${l}`;r.checked=localStorage.getItem(p)==="1",r.addEventListener("change",()=>localStorage.setItem(p,r.checked?"1":"0"))});let s=[...document.querySelectorAll("button")].find(r=>/save progress/i.test(r.textContent||""));s&&s.addEventListener("click",()=>{localStorage.setItem(`${t}progress-saved`,Date.now().toString()),alert("Progress saved locally!")});let n=[...document.querySelectorAll("button")].find(r=>/mark complete/i.test(r.textContent||""));if(n){let r=`${t}completed`;localStorage.getItem(r)==="1"&&(n.textContent="Completed \u2714",n.classList.add("bg-emerald-600")),n.addEventListener("click",l=>{l.preventDefault(),localStorage.setItem(r,"1"),n.textContent="Completed \u2714",n.classList.add("bg-emerald-600")})}}),window.initInstructions=function(){let s=`ss:${y("t","anon")}:lastApp`,n=document.querySelector("#instructions form")||document.querySelector("main#instructions form");if(!n)return;let r=n.querySelector('input[type="url"]'),l=n.querySelector('input[placeholder*="First"]'),p=n.querySelector('input[placeholder*="Second"]'),i=n.querySelector('input[placeholder*="Third"]'),c=n.querySelector("textarea");function a(o){if(!o)return;let e=o.dataset||{};r&&(r.value=e.url||""),l&&(l.value=e.step1||""),p&&(p.value=e.step2||""),i&&(i.value=e.step3||""),c&&(c.value=e.tip||""),e.app&&localStorage.setItem(s,e.app)}document.querySelectorAll("#compose details.group").forEach(o=>{let e=o.cloneNode(!0);o.parentNode.replaceChild(e,o)}),document.querySelectorAll("#compose details.group").forEach(o=>{o.addEventListener("toggle",()=>{o.open&&(document.querySelectorAll("#compose details.group").forEach(e=>{e!==o&&(e.open=!1)}),a(o.querySelector("summary")))})});let u=localStorage.getItem(s),d=!1;if(u){let o=[...document.querySelectorAll("#compose details.group summary")].find(e=>(e.dataset.app||"").toLowerCase()===u.toLowerCase());if(o){let e=o.closest("details.group");e&&(e.open=!0),a(o),d=!0}}if(!d){let o=document.querySelector("#compose details.group[open] summary")||document.querySelector("#compose details.group summary");o&&a(o)}},document.addEventListener("DOMContentLoaded",()=>m(()=>window.initInstructions?.())),document.addEventListener("DOMContentLoaded",()=>{let t=new WeakMap,s=()=>document.querySelectorAll("details").forEach(r=>{t.set(r,r.open),r.open=!0}),n=()=>document.querySelectorAll("details").forEach(r=>{let l=t.get(r);l!==void 0&&(r.open=l)});document.getElementById("print-plan")?.addEventListener("click",()=>{s(),setTimeout(()=>window.print(),50)}),window.addEventListener("beforeprint",s),window.addEventListener("afterprint",n)}),document.addEventListener("DOMContentLoaded",async()=>{try{let l=function(i){if(Array.isArray(i?.apps))return i.apps;let c=[];if(Array.isArray(i?.plans))c=i.plans;else if(i?.plan)c=[i.plan];else{let e=f(i?.result)||f(i?.output)||f(i?.plan_json)||f(i);Array.isArray(e?.plans)?c=e.plans:e?.plan&&(c=[e.plan])}let a=new Set,u=[],d=e=>{let h=(e?.app_name||"").trim();!h||a.has(h)||(a.add(h),u.push(e))};c[0]?.apps&&(c[0].apps||[]).forEach(d);for(let e=1;e<c.length&&u.length<5;e++)(c[e].apps||[]).forEach(d);let o=[{app_name:"Experian Boost",app_url:"https://www.experian.com/boost"},{app_name:"Kikoff",app_url:"https://www.kikoff.com/"},{app_name:"Kovo",app_url:"https://www.kovo.com/"}];for(let e of o){if(u.length>=3)break;a.has(e.app_name)||u.push(e)}return u.slice(0,5)},t=document.getElementById("sidebar-slot");if(!t)return;if(t.children.length>0){m(()=>window.lucide&&lucide.createIcons()),m(()=>window.initInstructions&&window.initInstructions());return}let s=y("stackKey","foundation"),n=await fetch(`/api/gpt-plan?stackKey=${encodeURIComponent(s)}`,{method:"GET"});if(!n.ok)throw new Error(`/api/gpt-plan ${n.status}`);let r=await n.json(),p=l(r);if(t.innerHTML=p.map((i,c)=>{let a=i.app_name||i.name||"App",u=i.app_url||i.url||"",[d,o,e]=g(a,i);return`
<details class="group"${c===0?" open":""}>
  <summary class="w-full flex items-center justify-between px-3 py-2 bg-lime-600 text-black rounded-md hover:bg-lime-500 transition-colors text-xs font-medium cursor-pointer"
    data-app="${a}" data-url="${u}" data-step1="${d}" data-step2="${o}" data-step3="${e}">
    <span class="flex items-center space-x-1.5">
      <i data-lucide="${w(a)}" class="w-3.5 h-3.5"></i><span>${a}</span>
    </span>
    <i data-lucide="chevron-down" class="w-3 h-3 chev"></i>
  </summary>
  <ul class="mt-3 space-y-2 px-3 pb-3">
    <li class="flex items-center justify-between text-xs text-zinc-300"><span>${d}</span><input type="checkbox" class="w-3 h-3 rounded border-white/10 bg-zinc-800 text-lime-600"></li>
    <li class="flex items-center justify-between text-xs text-zinc-300"><span>${o}</span><input type="checkbox" class="w-3 h-3 rounded border-white/10 bg-zinc-800 text-lime-600"></li>
    <li class="flex items-center justify-between text-xs text-zinc-300"><span>${e}</span><input type="checkbox" class="w-3 h-3 rounded border-white/10 bg-zinc-800 text-lime-600"></li>
  </ul>
</details>`}).join(""),m(()=>window.lucide&&lucide.createIcons()),m(()=>window.initInstructions&&window.initInstructions()),p.length===3){let i=document.querySelector("#compose .mt-4")||document.querySelector("#compose");if(i){let c=document.createElement("p");c.className="text-xs italic text-zinc-400 mt-2",c.textContent="Your starter stack includes 3 apps (min spec). More can be added based on your profile.",i.appendChild(c)}}}catch(t){console.error("plan.runtime \u2192 API wire failed:",t)}})})();})();
//# sourceMappingURL=plan.runtime.js.map
